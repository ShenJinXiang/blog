<!doctype html>
<html lang="zh-CN">
<head>
	<meta charset="utf-8">
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
	<meta content="yes" name="apple-mobile-web-app-capable">
	<meta content="black-translucent" name="apple-mobile-web-app-status-bar-style">
	<meta content="telephone=no" name="format-detection">
	<meta name="keywords" content="LiksStar ShenJinXiang 申锦祥 java 博客">
	<meta name="description" content="LiksStar ShenJinXiang 申锦祥 java 博客">
	<link rel='icon' href="../../../images/title.ico" type="image/x-ico" />
	<link rel="stylesheet" href="../../../plugin/prism/prism.css">
	<link rel="stylesheet" href="../../../css/style.css">
	<title>LikeStar</title>
</head>
<body>
<div id="temp_content" style="display: none;">
	<div class="post-content">
<!-- 正文开始 -->
<p>注解（Annotation），也叫元数据。一种代码级别的说明。它是JDK1.5及以后版本引入的一个特性，与类、接口、枚举是在同一个层次。它可以声明在包、类、字段、方法、局部变量、方法参数等的前面，用来对这些元素进行说明，注释, 可以替换xml配置文件。</p>
<h3>jdk中常见的注解</h3>
<ul>
	<li>@Override 限定重写父类方法，只能用于方法上</li>
	<li>@Deprecated 用于表示某个程序元素(类、方法等)已过时</li>
	<li>@SuppressWarnings 抑制编译器警告</li>
</ul>
<br><hr><br>
<h3>按运行机制分类</h3>
<ul>
	<li>源码注解 注解只能在源码中存在，编译成class文件就不存在了</li>
	<li>编译时注解 在class文件中仍存在</li>
	<li>运行时注解 在运行阶段还气作用，甚至会影响运行逻辑的注解</li>
</ul>
<br><hr><br>
<h3>自定义注解</h3>
<p>java中使用@interface申明注解, 定义注解的格式：</p>
<pre>
<code>
public @interface 注解名{定义体}
</code>
</pre>
<p>代码示例：</p>
<pre class='line-numbers language-java'>
<code>
public @interface MyAnnotation1 {
	// 零个或多个属性
}
</code>
</pre>
<h4>注解的属性</h4>
<p>注解中可以带属性，比如定义包含name和age属性的注解，如下：</p>
<pre class='line-numbers language-java'>
<code>
public @interface MyAnnotation {

    String name() default "hello";
    int age();
}
</code>
</pre>
<p>使用方式：</p>
<pre class='line-numbers language-java'>
<code>
@MyAnnotation(name = "ZhangSan", age = 18)
public void test() {
    // do something
}
</code>
</pre>
<p>1. 注解中的成员属性的数量可以是0个、1个或者多个，如果没有成员属性，则成该注解为标记注解</p>
<P>2. 如果注解中只有一个成员属性，可以将其属性名称设置为value，在使用该注解的时候，不需要制定属性名</p>
<p>3. 注解可以设置默认值，如上例中的name属性设置了默认值“hello”</p>
<p>4. 成员属性的类型并不是随意的，类型范围有：</p>
<ul>
	<li>String类型</li>
	<li>java中的基本类型</li>
	<li>Class类型</li>
	<li>枚举类型</li>
	<li>注解类型</li>
	<li>以上类型的一维数组</li>
</ul>
<h4>元注解</h4>
<p>元注解是指用来修饰注解的注解</p>
<h5>@Target</h5>
<p>@Target用来描述Annotation作用的元素范围，如果没有申明，则默认可以用在任一程序元素上。 @Target的源码：</p>
<pre class='line-numbers language-java'>
<code>
@Documented
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.ANNOTATION_TYPE)
public @interface Target {
    ElementType[] value();
}
</code>
</pre>
<p>可以看到@Target注解只有一个成员属性value，所以在使用时，可以省略属性名称，同时value的类型是ElementType的一维数组，查看ElementType源码：</p>
<pre class='line-numbers language-java'>
<code>
public enum ElementType {
    TYPE, // 用于描述类、接口(包括注解)、枚举

    FIELD, // 用于描述字段 (包括枚举中的字段)

    METHOD, // 用于描述方法

    PARAMETER, // 用于描述参数

    CONSTRUCTOR, // 用于描述构造方法

    LOCAL_VARIABLE, // 用于描述局部变量

    ANNOTATION_TYPE, // 用于描述注解

    PACKAGE, // 用于描述包

    TYPE_PARAMETER, 

    TYPE_USE
}
</code>
</pre>
<p>接下来就可以使用了, 可以根据实际情况，设置注解使用的范围</p>
<pre class='line-numbers language-java'>
<code>
@Target({ElementType.TYPE, ElementType.FIELD, ElementType.METHOD})
public @interface MyAnnotation {

    String value();
}
</code>
</pre>
<br><hr><br>
<h5>@Retention</h5>
<p>@Retention指示注释类型的注释要保留多久,即用来描述注解的作用域，java源代码 --- class文件 --- 运行时</p>
<pre class='line-numbers language-java'>
<code>
@Documented
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.ANNOTATION_TYPE)
public @interface Retention {

    RetentionPolicy value();
}
</code>
</pre>
<p>@Retention同样只有一个成员属性value，类型为RetentionPolicy，查看源码可以知道RetentionPolicy是一个枚举，源码为：</p>
<pre class='line-numbers language-java'>
<code>
public enum RetentionPolicy {
    SOURCE, // 在源文件中有效, 即.java文件中有效
	
	CLASS, // 在class文件中有效(默认值)
		
	RUNTIME // 在运行时有效
}
</code>
</pre>
<p>如果不对@Retention进行设置，默认值为RetentionPolicy.CLASS。通常，我们需要通过反射技术对注解做一些逻辑处理，那么需要将值设定为RetentionPolicy.RUNTIME</p>
<br><hr><br>
<h5>@Inherited</h5>
<p>@Inherited注解用于描述被标注的类型是可以继承的，如果一个使用了@Inherited修饰的Annotation类型被用于一个class，则这个Annotation将被用于该class的子类 @Inherited的源码：</p>
<pre class='line-numbers language-java'>
<code>
@Documented
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.ANNOTATION_TYPE)
public @interface Inherited {
}
</code>
</pre>
<p>Inherited注解没有属性，是一个标记注解</p>
<br><hr><br>
<h5>@Documented</h5>
<p>@Documented用于描述其它类型的annotation应该被作为被标注的程序成员的公共API，因此可以被例如javadoc此类的工具文档化。Documented是一个标记注解，没有成员,源码如下：</p>
<pre class='line-numbers language-java'>
<code>
@Documented
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.ANNOTATION_TYPE)
public @interface Documented {
}
</code>
</pre>
<br><hr><br>
<h3>解析注解</h3>
<p>1. 通过反射技术获取到需要解析的类、字段或者方法</p>
<p>2. 获取注解实例 </p>
<p>3. 获取注解属性的值</p>

<!-- 正文结束 -->
	</div>
</div>
<script src="../../../plugin/jquery/jquery.js"></script>
<script src="../../../plugin/prism/prism.js"></script>
<script src="../../../js/main.js"></script>
<script><!--{{{-->
$(function(){
	LS.init({
		'currentMenu' : 1,
		'sidebar' : ['date', 'category', 'tags', 'post'],
		'content' : {
			'type' : 'post',
			'id' : 13
		}
	});

});
</script><!--}}}-->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript"><!--{{{-->
var duoshuoQuery = {short_name:"shenjinxiang"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script><!--}}}-->
<!-- 多说公共JS代码 end -->
</body>
</html>



